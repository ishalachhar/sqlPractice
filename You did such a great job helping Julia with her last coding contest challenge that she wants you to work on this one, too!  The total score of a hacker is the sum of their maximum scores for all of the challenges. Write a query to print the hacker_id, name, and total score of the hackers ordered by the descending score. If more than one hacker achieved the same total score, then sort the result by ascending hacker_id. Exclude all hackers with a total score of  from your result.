Select sq.hacker_id,sq.name,sum(sq.scores)as total_score from (select h.hacker_id, h.name,hi.challenge_id, max(hi.score) as scores from hackers h inner join submissions hi on h.hacker_id=hi.hacker_id group by 1,2,3 ) as SQ where sq.scores != 0 group by 1,2 order by total_score desc,sq.hacker_id asc 
